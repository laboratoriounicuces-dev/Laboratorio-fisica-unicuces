<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Energía Cinética - UNICUCES</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Exo+2:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --deep-navy: #0f0c29;
            --dark-purple: #302b63;
            --medium-purple: #4a3f8c;
            --light-purple: #6a52b5;
            --electric-blue: #2196f3;
            --light-blue: #64b5f6;
            --lavender: #b39ddb;
            --white: #ffffff;
            --light-gray: #f5f7ff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, var(--deep-navy), var(--dark-purple));
            color: var(--white);
            line-height: 1.6;
            min-height: 100vh;
            font-family: 'Exo 2', sans-serif;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        /* Simulator Section */
        .simulator-section {
            padding: 2rem 0;
            background: linear-gradient(rgba(15, 12, 41, 0.9), rgba(48, 43, 99, 0.95));
            position: relative;
            overflow: hidden;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.8rem;
            color: var(--light-blue);
            position: relative;
            font-family: 'Rajdhani', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 4px;
            background: linear-gradient(to right, var(--electric-blue), var(--light-purple));
            border-radius: 2px;
        }
        
        .simulator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2.5rem;
            margin-bottom: 3rem;
        }
        
        .controls-panel {
            background: linear-gradient(145deg, var(--dark-purple), var(--medium-purple));
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 181, 246, 0.2);
        }
        
        .control-group {
            margin-bottom: 1.5rem;
        }
        
        .control-label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--lavender);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .slider {
            flex: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--electric-blue);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.7);
        }
        
        .slider-value {
            min-width: 80px;
            text-align: center;
            background: rgba(33, 150, 243, 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            font-weight: 600;
            color: var(--light-blue);
        }
        
        .simulation-area {
            background: linear-gradient(145deg, var(--dark-purple), var(--medium-purple));
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 181, 246, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .animation-container {
            width: 100%;
            height: 350px;
            position: relative;
            margin-bottom: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            background: rgba(15, 12, 41, 0.5);
            border: 1px solid rgba(100, 181, 246, 0.3);
        }
        
        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30px;
            background: linear-gradient(to top, #5d4037, #8d6e63);
            z-index: 1;
        }
        
        .object {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--electric-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(33, 150, 243, 0.7);
            z-index: 2;
            transition: all 0.05s linear;
            transform: translate(-50%, -50%);
        }
        
        .energy-trail {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .trail-dot {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--light-blue);
            opacity: 0.7;
            transform: translate(-50%, -50%);
        }
        
        .energy-display {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            width: 100%;
            justify-content: space-between;
        }
        
        .energy-value {
            text-align: center;
            padding: 1rem;
            background: rgba(33, 150, 243, 0.2);
            border-radius: 8px;
            flex: 1;
            transition: all 0.3s ease;
        }
        
        .energy-value.active {
            background: rgba(33, 150, 243, 0.4);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(33, 150, 243, 0.5);
        }
        
        .energy-label {
            font-size: 0.9rem;
            color: var(--lavender);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }
        
        .energy-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--light-blue);
            font-family: 'Rajdhani', sans-serif;
        }
        
        .graph-container {
            background: linear-gradient(145deg, var(--dark-purple), var(--medium-purple));
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 181, 246, 0.2);
            margin-bottom: 3rem;
            height: 400px;
        }
        
        .theory-section {
            background: linear-gradient(145deg, var(--dark-purple), var(--medium-purple));
            border-radius: 16px;
            padding: 2.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 181, 246, 0.2);
            margin-bottom: 3rem;
        }
        
        .theory-title {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.8rem;
            color: var(--light-blue);
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .theory-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .theory-text {
            color: var(--lavender);
            line-height: 1.7;
        }
        
        .theory-text p {
            margin-bottom: 1.2rem;
        }
        
        .formula-box {
            background: rgba(15, 12, 41, 0.5);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(100, 181, 246, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .formula {
            font-size: 2.5rem;
            font-family: 'Rajdhani', sans-serif;
            color: var(--light-blue);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .formula-explanation {
            color: var(--lavender);
            text-align: center;
            line-height: 1.6;
        }
        
        .button {
            background: linear-gradient(to right, var(--electric-blue), var(--light-purple));
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Exo 2', sans-serif;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }
        
        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.6);
        }
        
        .button:active {
            transform: translateY(-1px);
        }
        
        .button-reset {
            background: linear-gradient(to right, #f44336, #e91e63);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
        }
        
        .button-reset:hover {
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.6);
        }
        
        .buttons-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }
        
        .zoom-info {
            margin-top: 1rem;
            text-align: center;
            color: var(--lavender);
            font-size: 0.9rem;
        }
        
        /* Physics Animation */
        .physics-animation {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            background: var(--electric-blue);
            border-radius: 50%;
            opacity: 0.3;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) translateX(0);
            }
            50% {
                transform: translateY(-20px) translateX(10px);
            }
            100% {
                transform: translateY(0) translateX(0);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .simulator-container {
                grid-template-columns: 1fr;
            }
            
            .theory-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .section-title {
                font-size: 2.2rem;
            }
            
            .energy-display {
                flex-direction: column;
                gap: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }
            
            .simulator-section {
                padding: 1rem 0;
            }
            
            .controls-panel, .simulation-area, .graph-container, .theory-section {
                padding: 1.5rem;
            }
            
            .formula {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Physics Animation -->
    <div class="physics-animation" id="physics-animation"></div>

    <!-- Simulator Section -->
    <section class="simulator-section">
        <div class="container">
            <h2 class="section-title">SIMULADOR DE ENERGÍA CINÉTICA</h2>
            
            <div class="simulator-container">
                <div class="controls-panel">
                    <div class="control-group">
                        <label class="control-label">MASA DEL OBJETO (kg)</label>
                        <div class="slider-container">
                            <input type="range" min="1" max="100" value="10" class="slider" id="mass-slider">
                            <span class="slider-value" id="mass-value">10 kg</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">VELOCIDAD INICIAL (m/s)</label>
                        <div class="slider-container">
                            <input type="range" min="0" max="100" value="15" class="slider" id="velocity-slider">
                            <span class="slider-value" id="velocity-value">15 m/s</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ALTURA INICIAL (m)</label>
                        <div class="slider-container">
                            <input type="range" min="0" max="500" value="200" class="slider" id="height-slider">
                            <span class="slider-value" id="height-value">200 m</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label class="control-label">ÁNGULO DE LANZAMIENTO (°)</label>
                        <div class="slider-container">
                            <input type="range" min="0" max="90" value="45" class="slider" id="angle-slider">
                            <span class="slider-value" id="angle-value">45°</span>
                        </div>
                    </div>
                    
                    <div class="buttons-container">
                        <button class="button" id="start-button">INICIAR SIMULACIÓN</button>
                        <button class="button button-reset" id="reset-button">REINICIAR</button>
                    </div>
                </div>
                
                <div class="simulation-area">
                    <div class="animation-container" id="animation-container">
                        <div class="energy-trail" id="energy-trail"></div>
                        <div class="object" id="moving-object">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="ground"></div>
                    </div>
                    
                    <div class="energy-display">
                        <div class="energy-value" id="kinetic-energy-display">
                            <div class="energy-label">Energía Cinética</div>
                            <div class="energy-number" id="kinetic-energy">0 J</div>
                        </div>
                        <div class="energy-value" id="potential-energy-display">
                            <div class="energy-label">Energía Potencial</div>
                            <div class="energy-number" id="potential-energy">0 J</div>
                        </div>
                        <div class="energy-value" id="total-energy-display">
                            <div class="energy-label">Energía Total</div>
                            <div class="energy-number" id="total-energy">0 J</div>
                        </div>
                    </div>
                    
                    <div class="zoom-info" id="zoom-info">
                        Vista completa de la trayectoria (escala automática)
                    </div>
                </div>
            </div>
            
            <div class="graph-container">
                <canvas id="energy-chart"></canvas>
            </div>
            
            <div class="theory-section">
                <h3 class="theory-title">TEORÍA DE LA ENERGÍA CINÉTICA</h3>
                
                <div class="theory-content">
                    <div class="theory-text">
                        <p>La energía cinética es la energía que posee un objeto debido a su movimiento. Depende de la masa del objeto y de su velocidad, y se calcula mediante la fórmula:</p>
                        
                        <p>Cuando un objeto se mueve, tiene la capacidad de realizar trabajo sobre otros objetos. Por ejemplo, una bola en movimiento puede empujar otra bola, una flecha en movimiento puede penetrar un objetivo, etc.</p>
                        
                        <p>La energía cinética es una cantidad escalar, lo que significa que solo tiene magnitud, no dirección. Siempre es un valor positivo, ya que tanto la masa como el cuadrado de la velocidad son siempre positivos.</p>
                        
                        <p>En este simulador, puedes observar cómo cambia la energía cinética de un objeto en movimiento parabólico. A medida que el objeto se mueve, su energía potencial gravitatoria se convierte en energía cinética y viceversa, pero la energía total se conserva (principio de conservación de la energía).</p>
                        
                        <p>El ángulo de lanzamiento afecta la trayectoria del objeto, permitiendo observar diferentes distribuciones entre energía cinética y potencial a lo largo del movimiento.</p>
                    </div>
                    
                    <div class="formula-box">
                        <div class="formula">Ec = ½ m v²</div>
                        <div class="formula-explanation">
                            Donde:<br>
                            Ec = Energía cinética (en julios)<br>
                            m = Masa del objeto (en kilogramos)<br>
                            v = Velocidad del objeto (en metros/segundo)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Variables globales
        let simulationInterval;
        let isSimulationRunning = false;
        let currentTime = 0;
        let timeData = [];
        let kineticData = [];
        let potentialData = [];
        let totalData = [];
        let trailDots = [];
        let scaleFactor = 1;
        let maxX = 0;
        let maxY = 0;
        
        // Elementos del DOM
        const massSlider = document.getElementById('mass-slider');
        const massValue = document.getElementById('mass-value');
        const velocitySlider = document.getElementById('velocity-slider');
        const velocityValue = document.getElementById('velocity-value');
        const heightSlider = document.getElementById('height-slider');
        const heightValue = document.getElementById('height-value');
        const angleSlider = document.getElementById('angle-slider');
        const angleValue = document.getElementById('angle-value');
        const startButton = document.getElementById('start-button');
        const resetButton = document.getElementById('reset-button');
        const movingObject = document.getElementById('moving-object');
        const animationContainer = document.getElementById('animation-container');
        const energyTrail = document.getElementById('energy-trail');
        const kineticEnergyDisplay = document.getElementById('kinetic-energy-display');
        const potentialEnergyDisplay = document.getElementById('potential-energy-display');
        const totalEnergyDisplay = document.getElementById('total-energy-display');
        const kineticEnergyValue = document.getElementById('kinetic-energy');
        const potentialEnergyValue = document.getElementById('potential-energy');
        const totalEnergyValue = document.getElementById('total-energy');
        const zoomInfo = document.getElementById('zoom-info');
        
        // Configuración inicial de los controles
        massSlider.addEventListener('input', function() {
            massValue.textContent = this.value + ' kg';
            if (!isSimulationRunning) {
                updateEnergyDisplay();
            }
        });
        
        velocitySlider.addEventListener('input', function() {
            velocityValue.textContent = this.value + ' m/s';
            if (!isSimulationRunning) {
                updateEnergyDisplay();
            }
        });
        
        heightSlider.addEventListener('input', function() {
            heightValue.textContent = this.value + ' m';
            if (!isSimulationRunning) {
                updateEnergyDisplay();
                updateObjectPosition(parseFloat(this.value), 0);
            }
        });
        
        angleSlider.addEventListener('input', function() {
            angleValue.textContent = this.value + '°';
            if (!isSimulationRunning) {
                updateEnergyDisplay();
            }
        });
        
        // Función para calcular la trayectoria completa y determinar la escala
        function calculateTrajectoryAndScale() {
            const mass = parseFloat(massSlider.value);
            const initialVelocity = parseFloat(velocitySlider.value);
            const initialHeight = parseFloat(heightSlider.value);
            const angle = parseFloat(angleSlider.value) * Math.PI / 180;
            const g = 9.8;
            
            // Componentes de velocidad inicial
            const vx = initialVelocity * Math.cos(angle);
            const vy = initialVelocity * Math.sin(angle);
            
            // Calcular tiempo total de vuelo
            const timeToGround = (vy + Math.sqrt(vy*vy + 2*g*initialHeight)) / g;
            
            // Calcular alcance máximo
            const maxRange = vx * timeToGround;
            
            // Calcular altura máxima
            const maxHeight = initialHeight + (vy*vy) / (2*g);
            
            // Determinar dimensiones máximas
            maxX = Math.max(maxRange, 1); // Evitar división por cero
            maxY = Math.max(maxHeight, initialHeight, 1);
            
            // Calcular factor de escala para que quepa en el contenedor
            const containerWidth = animationContainer.clientWidth;
            const containerHeight = animationContainer.clientHeight - 30; // Restar altura del suelo
            
            const scaleX = containerWidth / maxX;
            const scaleY = containerHeight / maxY;
            
            // Usar el factor de escala más pequeño para mantener proporciones
            scaleFactor = Math.min(scaleX, scaleY) * 0.9; // 90% para dejar margen
            
            // Actualizar información de zoom
            zoomInfo.textContent = `Vista completa (escala: 1:${(1/scaleFactor).toFixed(1)})`;
        }
        
        // Función para actualizar la posición del objeto
        function updateObjectPosition(height, horizontalPos) {
            // Convertir coordenadas reales a coordenadas de pantalla
            const screenX = horizontalPos * scaleFactor;
            const screenY = (maxY - height) * scaleFactor;
            
            // Aplicar posición
            movingObject.style.left = screenX + 'px';
            movingObject.style.top = screenY + 'px';
        }
        
        // Función para calcular la energía cinética
        function calculateKineticEnergy(mass, velocity) {
            return 0.5 * mass * Math.pow(velocity, 2);
        }
        
        // Función para calcular la energía potencial
        function calculatePotentialEnergy(mass, height) {
            const g = 9.8;
            return mass * g * height;
        }
        
        // Función para actualizar las visualizaciones de energía
        function updateEnergyDisplay() {
            const mass = parseFloat(massSlider.value);
            const velocity = parseFloat(velocitySlider.value);
            const height = parseFloat(heightSlider.value);
            
            const kineticEnergy = calculateKineticEnergy(mass, velocity);
            const potentialEnergy = calculatePotentialEnergy(mass, height);
            const totalEnergy = kineticEnergy + potentialEnergy;
            
            kineticEnergyValue.textContent = kineticEnergy.toFixed(2) + ' J';
            potentialEnergyValue.textContent = potentialEnergy.toFixed(2) + ' J';
            totalEnergyValue.textContent = totalEnergy.toFixed(2) + ' J';
        }
        
        // Función para agregar un punto de rastro de energía
        function addTrailDot(x, y, energyType) {
            const dot = document.createElement('div');
            dot.classList.add('trail-dot');
            
            // Color basado en el tipo de energía
            if (energyType === 'kinetic') {
                dot.style.background = '#2196f3';
            } else if (energyType === 'potential') {
                dot.style.background = '#6a52b5';
            } else {
                dot.style.background = '#4caf50';
            }
            
            // Convertir coordenadas reales a coordenadas de pantalla
            const screenX = x * scaleFactor;
            const screenY = (maxY - y) * scaleFactor;
            
            dot.style.left = screenX + 'px';
            dot.style.top = screenY + 'px';
            
            energyTrail.appendChild(dot);
            trailDots.push(dot);
            
            // Limitar el número de puntos de rastro
            if (trailDots.length > 100) {
                const oldDot = trailDots.shift();
                if (oldDot && oldDot.parentNode) {
                    oldDot.parentNode.removeChild(oldDot);
                }
            }
            
            // Desvanecer puntos con el tiempo
            setTimeout(() => {
                if (dot.parentNode) {
                    dot.style.opacity = '0.3';
                }
            }, 500);
            
            setTimeout(() => {
                if (dot.parentNode) {
                    dot.style.opacity = '0.1';
                }
            }, 1000);
            
            setTimeout(() => {
                if (dot.parentNode && trailDots.includes(dot)) {
                    dot.parentNode.removeChild(dot);
                    trailDots = trailDots.filter(d => d !== dot);
                }
            }, 2000);
        }
        
        // Función para iniciar la simulación
        function startSimulation() {
            if (isSimulationRunning) {
                pauseSimulation();
                return;
            }
            
            isSimulationRunning = true;
            startButton.textContent = 'PAUSAR SIMULACIÓN';
            
            // Calcular trayectoria y escala
            calculateTrajectoryAndScale();
            
            // Reiniciar datos del gráfico
            timeData = [];
            kineticData = [];
            potentialData = [];
            totalData = [];
            currentTime = 0;
            
            // Limpiar rastro de energía
            trailDots.forEach(dot => {
                if (dot.parentNode) dot.parentNode.removeChild(dot);
            });
            trailDots = [];
            
            // Configurar el gráfico
            setupChart();
            
            // Iniciar el intervalo de simulación
            simulationInterval = setInterval(updateSimulation, 50);
        }
        
        // Función para pausar la simulación
        function pauseSimulation() {
            isSimulationRunning = false;
            startButton.textContent = 'REANUDAR SIMULACIÓN';
            clearInterval(simulationInterval);
            
            // Quitar clases activas de los displays de energía
            kineticEnergyDisplay.classList.remove('active');
            potentialEnergyDisplay.classList.remove('active');
            totalEnergyDisplay.classList.remove('active');
        }
        
        // Función para actualizar la simulación
        function updateSimulation() {
            const mass = parseFloat(massSlider.value);
            const initialVelocity = parseFloat(velocitySlider.value);
            const initialHeight = parseFloat(heightSlider.value);
            const angle = parseFloat(angleSlider.value) * Math.PI / 180;
            const g = 9.8;
            
            // Componentes de velocidad inicial
            const vx = initialVelocity * Math.cos(angle);
            const vy = initialVelocity * Math.sin(angle);
            
            // Calcular posición actual
            const currentX = vx * currentTime;
            const currentY = initialHeight + vy * currentTime - 0.5 * g * Math.pow(currentTime, 2);
            
            // Calcular velocidad actual
            const currentVy = vy - g * currentTime;
            const currentSpeed = Math.sqrt(Math.pow(vx, 2) + Math.pow(currentVy, 2));
            
            // Si hemos alcanzado el suelo, detener la simulación
            if (currentY <= 0) {
                pauseSimulation();
                startButton.textContent = 'INICIAR SIMULACIÓN';
                return;
            }
            
            // Calcular las energías
            const kineticEnergy = calculateKineticEnergy(mass, currentSpeed);
            const potentialEnergy = calculatePotentialEnergy(mass, currentY);
            const totalEnergy = kineticEnergy + potentialEnergy;
            
            // Actualizar las visualizaciones
            kineticEnergyValue.textContent = kineticEnergy.toFixed(2) + ' J';
            potentialEnergyValue.textContent = potentialEnergy.toFixed(2) + ' J';
            totalEnergyValue.textContent = totalEnergy.toFixed(2) + ' J';
            
            // Resaltar el tipo de energía dominante
            kineticEnergyDisplay.classList.remove('active');
            potentialEnergyDisplay.classList.remove('active');
            totalEnergyDisplay.classList.remove('active');
            
            if (kineticEnergy > potentialEnergy) {
                kineticEnergyDisplay.classList.add('active');
            } else {
                potentialEnergyDisplay.classList.add('active');
            }
            
            // Actualizar la posición del objeto
            updateObjectPosition(currentY, currentX);
            
            // Agregar punto de rastro
            addTrailDot(currentX, currentY, kineticEnergy > potentialEnergy ? 'kinetic' : 'potential');
            
            // Guardar datos para el gráfico
            timeData.push(currentTime.toFixed(1));
            kineticData.push(kineticEnergy);
            potentialData.push(potentialEnergy);
            totalData.push(totalEnergy);
            
            // Actualizar el gráfico
            updateChart();
            
            // Incrementar el tiempo
            currentTime += 0.1;
        }
        
        // Función para reiniciar la simulación
        function resetSimulation() {
            pauseSimulation();
            startButton.textContent = 'INICIAR SIMULACIÓN';
            currentTime = 0;
            
            // Calcular trayectoria y escala
            calculateTrajectoryAndScale();
            
            // Posicionar objeto en posición inicial
            const initialHeight = parseFloat(heightSlider.value);
            updateObjectPosition(initialHeight, 0);
            
            updateEnergyDisplay();
            
            // Limpiar rastro de energía
            trailDots.forEach(dot => {
                if (dot.parentNode) dot.parentNode.removeChild(dot);
            });
            trailDots = [];
            
            // Limpiar el gráfico
            timeData = [];
            kineticData = [];
            potentialData = [];
            totalData = [];
            setupChart();
        }
        
        // Configuración del gráfico
        let energyChart;
        
        function setupChart() {
            const ctx = document.getElementById('energy-chart').getContext('2d');
            
            if (energyChart) {
                energyChart.destroy();
            }
            
            energyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: timeData,
                    datasets: [
                        {
                            label: 'Energía Cinética (J)',
                            data: kineticData,
                            borderColor: '#2196f3',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Energía Potencial (J)',
                            data: potentialData,
                            borderColor: '#6a52b5',
                            backgroundColor: 'rgba(106, 82, 181, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Energía Total (J)',
                            data: totalData,
                            borderColor: '#4caf50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            borderDash: [5, 5],
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Tiempo (s)',
                                color: '#b39ddb',
                                font: {
                                    size: 14,
                                    family: 'Exo 2'
                                }
                            },
                            grid: {
                                color: 'rgba(179, 157, 219, 0.2)'
                            },
                            ticks: {
                                color: '#b39ddb',
                                font: {
                                    family: 'Exo 2'
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Energía (J)',
                                color: '#b39ddb',
                                font: {
                                    size: 14,
                                    family: 'Exo 2'
                                }
                            },
                            grid: {
                                color: 'rgba(179, 157, 219, 0.2)'
                            },
                            ticks: {
                                color: '#b39ddb',
                                font: {
                                    family: 'Exo 2'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#b39ddb',
                                font: {
                                    family: 'Exo 2',
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 12, 41, 0.9)',
                            titleColor: '#b39ddb',
                            bodyColor: '#b39ddb',
                            borderColor: '#64b5f6',
                            borderWidth: 1
                        }
                    }
                }
            });
        }
        
        function updateChart() {
            energyChart.data.labels = timeData;
            energyChart.data.datasets[0].data = kineticData;
            energyChart.data.datasets[1].data = potentialData;
            energyChart.data.datasets[2].data = totalData;
            energyChart.update('none');
        }
        
        // Crear partículas flotantes para el efecto de física
        function createParticles() {
            const physicsAnimation = document.getElementById('physics-animation');
            const colors = ['#2196f3', '#64b5f6', '#6a52b5', '#b39ddb'];
            
            for (let i = 0; i < 25; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Tamaño aleatorio
                const size = Math.random() * 20 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Posición aleatoria
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Color aleatorio
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                // Animación con delay aleatorio
                particle.style.animationDelay = `${Math.random() * 15}s`;
                
                physicsAnimation.appendChild(particle);
            }
        }
        
        // Event listeners para los botones
        startButton.addEventListener('click', startSimulation);
        
        resetButton.addEventListener('click', resetSimulation);
        
        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Calcular trayectoria y escala inicial
            calculateTrajectoryAndScale();
            
            // Posicionar objeto en posición inicial
            const initialHeight = parseFloat(heightSlider.value);
            updateObjectPosition(initialHeight, 0);
            
            updateEnergyDisplay();
            setupChart();
            createParticles();
        });
    </script>
</body>
</html>